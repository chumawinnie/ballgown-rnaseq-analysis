/*
===============================================================================
CUSTOM NEXTFLOW CONFIGURATION
For nf-core/rnaseq pipeline
Optimized for systems with 64-128 GB RAM
===============================================================================
*/

process {
    // Global configuration for all processes
    withName: ".*" {
        time = 72.h
    }
    
    // Configuration for STAR alignment
    withName: 'NFCORE_RNASEQ:ALIGN_STAR' {
        memory = '64 GB'
        cpus = 16
        time = '24h'
    }
    
    // Configuration for STAR genome indexing
    withName: 'STAR_GENOMEGENERATE' {
        memory = '64 GB'
        cpus = 16
        time = '12h'
    }
    
    // Configuration for SortMeRNA (ribosomal RNA removal)
    withName: 'SORTMERNA_INDEX' {
        memory = '120 GB'
        cpus = 16
        time = '48h'
    }
    
    withName: 'SORTMERNA' {
        memory = '32 GB'
        cpus = 8
        time = '12h'
    }
    
    // Configuration for Salmon quantification
    withName: 'SALMON_QUANT' {
        memory = '32 GB'
        cpus = 8
        time = '6h'
    }
    
    // Configuration for featureCounts
    withName: 'SUBREAD_FEATURECOUNTS' {
        memory = '16 GB'
        cpus = 4
        time = '4h'
    }
    
    // Configuration for StringTie (for Ballgown)
    withName: 'STRINGTIE_STRINGTIE' {
        memory = '16 GB'
        cpus = 8
        time = '6h'
    }
}

// Executor settings
executor {
    name = 'local'
    cpus = 16
    memory = '64 GB'
}

// Docker settings
docker {
    enabled = true
    runOptions = '-u $(id -u):$(id -g)'
}

// Singularity settings (alternative to Docker)
singularity {
    enabled = false
    autoMounts = true
}

// Report settings
report {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_report.html"
}

timeline {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_timeline.html"
}

trace {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_trace.txt"
}

dag {
    enabled = true
    file = "${params.outdir}/pipeline_info/pipeline_dag.svg"
}
